{"mappings":"ymBAUIA,EAAW,IAAIC,eAAe,aAAc,CAC9CC,aAAc,MACdC,aAAc,MAGK,MAAfC,EAAS,CACbC,KAAM,EACNC,SAAU,GACVC,EAAG,IAEL,IAAIC,EAAgB,EASM,SAAjBC,IACP,MAAMC,EAAeC,OAAOC,YACtBC,EAAYF,OAAOG,QACZC,EAAAC,KAAKC,QAAQC,aAEhBL,EAbS,IAakBH,EAClCG,EAAYH,IAqBfN,EAAOC,OACPc,I,CAyBFC,eAAeD,IACb,MAAME,EAAY,IAAIC,gBAAgB,IACjClB,EACHmB,WAAY,QACZC,YAAa,aACbC,QAAQ,EACRC,IAAKX,EAAAY,IAAIC,MAEX,IACE,MAAMC,QAAiBC,EAAAC,GAAMC,IAAI,GAAGjB,EAAAY,IAAIM,YAAYZ,KAC9Ca,EAAWL,EAASM,KAAKC,KAAKC,OAC9BC,EAAYT,EAASM,KAAKG,UAE4B,GAA1C,IAAdJ,EAAoC,IAAhB9B,EAAOC,KAK7B,OAJAkC,cAAc/B,QACdsB,EAAAU,GAASC,OAAOC,QACd,4EAKgB,IAAhBtC,EAAOC,MACTyB,EAAAU,GAASC,OAAOE,QAAQ,oBAAoBL,mBA1B3BM,EA6BCf,EAASM,KAAKC,UA5BpCrB,EAAAC,KAAKC,QAAQ4B,mBAAmB,aAAa,EAAAC,EAAAC,eAAcH,KA6BzD5C,EAASgD,UAETjC,EAAAC,KAAKiC,gBAAgBC,YAAc,IAChC9C,EAAOC,KAAO,GAAKD,EAAOE,SAAW4B,QACjCI,IAEHlC,EAAOC,KAAOD,EAAOE,UAAYgC,IACnCa,QAAQC,IAAI,4BACZb,cAAc/B,GACdsB,EAAAU,GAASC,OAAOY,QACd,8D,CAGJ,MAAOC,GACPH,QAAQC,IAAIE,E,CA5CQ,IAADV,C,CAvDvB7B,EAAAC,KAAKuC,KAAKC,iBAAiB,UAkBF,SAAHC,GACpBA,EAAEC,iBACoB,IAAlBlD,GACF+B,cAAc/B,GAGhBJ,EAAOC,KAAO,EACdD,EAAOG,EAAIkD,EAAEE,cAAcC,SAASC,YAAYC,MAChD/C,EAAAC,KAAKC,QAAQ8C,UAAY,GACzBhD,EAAAC,KAAKiC,gBAAgBC,YAAc,GACnC/B,IACAX,EAAgBwD,YAAYvD,EAAgB,I,IA3B9CE,OAAO6C,iBAAiB,UAAU,EAAAS,EAAAC,WA0CuC,WACvE,MAAMC,EAAWpD,EAAAC,KAAKoD,cAAcC,UAAUC,SAAS,aACjDC,EAAY5D,OAAOG,SAAgC,EAArBH,OAAOC,YACvC2D,EAAYJ,GACdpD,EAAAC,KAAKoD,cAAcC,UAAUG,OAAO,cAEjCD,GAAaJ,GAChBpD,EAAAC,KAAKoD,cAAcC,UAAUI,IAAI,Y,GAjDgB,MACrD1D,EAAAC,KAAKoD,cAAcZ,iBAAiB,SAkCsB,WACxD7C,OAAO+D,OAAO,CACZC,IAAK,EACLC,SAAU,U","sources":["src/js/index2.js"],"sourcesContent":["// імпортуємо бібліотеки\nimport '../css/styles.css';\nimport Notiflix from 'notiflix';\nimport axios from 'axios';\nimport { throttle } from 'lodash';\nimport simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs, api } from './refs'; //імпортую об\"єкт елементів refs і дані api ключ і базовий url\nimport { markUpGallery } from './markup_gallery'; //імпортую об\"єкт для побудови галереї з завантажених даних\n\nvar lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n//Параметри для пагінації\nconst params = {\n  page: 1,\n  per_page: 40,\n  q: '',\n};\nlet timerInterval = 0;\nconst TENDA_SCROLL = 1.3; //коефіцієнт спрацювання підгрузки елементів галереї, від висоти екрана\n// Події\nrefs.form.addEventListener('submit', onSubmitForm);\n// refs.buttonLoadMore.addEventListener('click', onClickButtonLoadMore);\nwindow.addEventListener('scroll', throttle(onScroll, 300));\nrefs.buttonPageTop.addEventListener('click', onClickButtonPageTop);\n\n// функція безперервного скрола\nfunction infiniteScroll() {\n  const heightWindow = window.innerHeight;\n  const positionY = window.scrollY;\n  const maxY = refs.gallery.clientHeight;\n  if (\n    (maxY - positionY < TENDA_SCROLL * heightWindow) &\n    (positionY > heightWindow)\n  ) {\n    onClickButtonLoadMore();\n  }\n}\n// функція-колбек події сабміта +\nfunction onSubmitForm(e) {\n  e.preventDefault();\n  if (timerInterval !== 0) {\n    clearInterval(timerInterval);\n  }\n\n  params.page = 1;\n  params.q = e.currentTarget.elements.searchQuery.value;\n  refs.gallery.innerHTML = '';\n  refs.outputPagesLoad.textContent = '';\n  fetchData();\n  timerInterval = setInterval(infiniteScroll, 500);\n}\n// функція-колбек для події на кнопці \"load-more\"+\nfunction onClickButtonLoadMore() {\n  params.page++;\n  fetchData();\n}\n// функція-колбек для події на клік на кнопці прокрутки на верх сторінки +\nfunction onClickButtonPageTop() {\n  window.scroll({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n// функція-колбек на подію скрол, добавляє чи ховає кнопку, щоб перейти на початок сторінки+\nfunction onScroll() {\n  const isHidden = refs.buttonPageTop.classList.contains('is-hidden');\n  const isVisible = window.scrollY >= window.innerHeight * 3;\n  if (isVisible & isHidden) {\n    refs.buttonPageTop.classList.remove('is-hidden');\n  }\n  if (!isVisible & !isHidden) {\n    refs.buttonPageTop.classList.add('is-hidden');\n  }\n}\n// функція для рендеру галереї +\nfunction renderGallery(users) {\n  refs.gallery.insertAdjacentHTML('beforeend', markUpGallery(users));\n}\n// fetch\nasync function fetchData() {\n  const parametrs = new URLSearchParams({\n    ...params,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    pretty: true,\n    key: api.KEY,\n  });\n  try {\n    const response = await axios.get(`${api.BASE_URL}?${parametrs}`);\n    const loadHits = response.data.hits.length;\n    const totalHits = response.data.totalHits;\n    // перевірка коли нічого не знаходить при першому запиті від користувача\n    if ((loadHits === 0) & (params.page === 1)) {\n      clearInterval(timerInterval);\n      Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n    // виводить кількість знайдених елементів при кліку на пошук\n    if (params.page === 1) {\n      Notiflix.Notify.success(`Hooray! We found ${totalHits} images.`);\n    }\n\n    await renderGallery(response.data.hits);\n    lightbox.refresh();\n\n    refs.outputPagesLoad.textContent = `${\n      (params.page - 1) * params.per_page + loadHits\n    } of ${totalHits}`;\n    // перевірка коли завантажили максимальну кількість елементів\n    if (params.page * params.per_page >= totalHits) {\n      console.log('треба виключити інтервал');\n      clearInterval(timerInterval);\n      Notiflix.Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n"],"names":["$c506fcfa6d35495e$var$lightbox","SimpleLightbox","captionsData","captionDelay","$c506fcfa6d35495e$var$params","page","per_page","q","$c506fcfa6d35495e$var$timerInterval","$c506fcfa6d35495e$var$infiniteScroll","heightWindow","window","innerHeight","positionY","scrollY","$krGWQ","refs","gallery","clientHeight","$c506fcfa6d35495e$var$fetchData","async","parametrs","URLSearchParams","image_type","orientation","pretty","key","api","KEY","response","$parcel$interopDefault","$2shzp","get","BASE_URL","loadHits","data","hits","length","totalHits","clearInterval","$eWCmQ","Notify","failure","success","users","insertAdjacentHTML","$8xxV0","markUpGallery","refresh","outputPagesLoad","textContent","console","log","warning","error","form","addEventListener","e","preventDefault","currentTarget","elements","searchQuery","value","innerHTML","setInterval","$kEUo3","throttle","isHidden","buttonPageTop","classList","contains","isVisible","remove","add","scroll","top","behavior"],"version":3,"file":"task2.1f00c625.js.map"}